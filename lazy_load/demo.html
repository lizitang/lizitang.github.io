<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="Autor" content="ghh">
	<meta name="keywords" content="">
	<meta name="Description" content="">
	<title>图片懒加载</title>
	<style type="text/css">
		*{
			margin: 0;
			padding: 0;
		}
		#box{
			width: 1035px;
			height: 500px;
			
			margin: 0 auto 0;/* 上 左右（自动相等）下 */
		}
		#box ul li{
			width: 225px;
			
			list-style: none;
			float: left;
			background: #fff;
			margin: 10px;
			padding: 5px;
			box-shadow:0 0 10px black; /*盒子阴影css3:水平偏移度 垂直偏移 阴影半径 阴影颜色*/
		}
		img{
			width: 225px;
			transition:1s;
		}
	</style>
</head>
<body>
	<div id="box">
		<ul>
			<li class="list"></li>
			<li class="list"></li>
			<li class="list"></li>
			<li class="list"></li>
		</ul>
	</div>
	<script type="text/javascript" src="jquery-3.1.1.min.js"></script>
	<script type="text/javascript">

	var arr = [//创建数组来保存这些图片
	{src:"images/1.png"},
	{src:"images/2.jpg"},
	{src:"images/3.jpg"},
	{src:"images/4.jpg"},
	{src:"images/5.jpg"},
	{src:"images/6.jpg"},
	{src:"images/7.jpg"},
	{src:"images/8.jpg"},
	{src:"images/9.jpg"},
	{src:"images/10.jpg"},
	{src:"images/11.jpg"},
	{src:"images/12.jpg"}
	];


	//实现瀑布流加载图片
	var i = 0;
	var sum ;
	function onload(){
		i++;
		if (i<12) {
			for(;i<12;i++){
				create();
			}
		}else{
			sum = i;
			for(;i < sum+3;i++){
				create();
			}
		}

		
	}
	onload();
	//生成一张图片
	function create(){
		//创建div盒子放置图片
		var oDiv = document.createElement("div");
		// 生成一个图片对象
		var oImg = new Image();
		//给oimg图片对象添加src路径
		//i%arr.length i(0-12) 0/12=0 yu0 11/12=0 yu 11
		oImg.src = arr[i%arr.length].src;
		//设置图片的样式
		oImg.style.cssText = "opcaity:0;transform:scale(0)";
		//把oImg添加到div盒子里面
		oDiv.appendChild(oImg);
		//把装有图片的div放到li列表里面
		getListDiv($('.list')).append(oDiv);
		//图片延时加载
		(function(oImg){
			setTimeout(function(){
				oImg.style.cssText = "opcaity:1;transform:scale(1)";
			},100);		
		})(oImg);//立马执行这个函数
	}

	//获取瀑布流的列数
	//判断最小高度在最小高度那列添加图片
	function getListDiv(obj){
		var length = obj.length;//总列数
		var h = Infinity;//每一列的高度 无限高
		var getList;//获取列表
		//获取每一列然后判断高度
		//eq(i)所有列中的第i列
		for(var i=0;i<length ;i++)
		{
			if(obj.eq(i).height() < h)
			{
				h = obj.eq(i).height();
				getList = obj.eq(i);
			}
		}
		return getList;		
	}

	//滚动添加图片
	var scrollH ;//文档 高度
	var scrollT ;//滚动条高度

	$(function(){//等同于 window.onload = function(){}
		var _height = $(window).height();//获取可视区的高度
		$(window).scroll(function(){//滚动条事件
			scrollH = document.body.scrollHeight;//文档高度
			scrollT = document.body.scrollTop;//滚动条高度
			if(_height + scrollT + 50 >scrollH){//滚动条高度加可视区高度加50 大于50时添加图片
				onload();
			}
		})
	})
	
	</script>
</body>
</html>